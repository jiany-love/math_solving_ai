<!DOCTYPE html>
<html lang="ko">
<head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ìˆ˜í•™ ë¬¸ì œ í’€ì´ AI ì„œë¹„ìŠ¤</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
        <h1>ğŸ§® ìˆ˜í•™ ë¬¸ì œ í’€ì´ AI</h1>
        <p class="subtitle">ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ OCR + ë¶„ì„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>

        <form method="post" enctype="multipart/form-data" class="upload-box">
                <input type="file" name="file" accept=".png,.jpg,.jpeg" required />
                <button type="submit">ì—…ë¡œë“œ & ë¶„ì„</button>
        </form>

        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <ul class="flash-messages">
                    {% for m in messages %}<li>{{ m }}</li>{% endfor %}
                </ul>
            {% endif %}
        {% endwith %}

        {% if uploaded_image %}
        <section class="panel">
                <h2>ğŸ“¤ ì—…ë¡œë“œëœ ì›ë³¸</h2>
                <img src="{{ url_for('static', filename=uploaded_image) }}" alt="ì—…ë¡œë“œ ì´ë¯¸ì§€" class="preview" />
        </section>
        {% endif %}

        {% if result_images %}
        <section class="panel">
                <h2>ğŸ–¼ï¸ ì²˜ë¦¬ëœ ê²°ê³¼ ì´ë¯¸ì§€ë“¤</h2>
                <div class="image-grid">
                        {% for img in result_images %}
                            <figure>
                                <img src="{{ url_for('static', filename=img) }}" alt="result" />
                                <figcaption>{{ img.split('/')[-1] }}</figcaption>
                            </figure>
                        {% endfor %}
                </div>
        </section>
        {% endif %}

        {% if ocr_text %}
        <section class="panel">
                <h2>ğŸ” OCR ì „ì²´ í…ìŠ¤íŠ¸</h2>
                <pre class="code-block">{{ ocr_text }}</pre>
        </section>
        {% endif %}

        {% if math_regions %}
        <section class="panel">
                <h2>ğŸ“Œ ìˆ˜í•™ ì˜ì—­ (ë¼ì¸ë³„)</h2>
                <table class="regions">
                        <thead>
                            <tr><th>#</th><th>í…ìŠ¤íŠ¸</th><th>ì˜ì—­</th></tr>
                        </thead>
                        <tbody>
                        {% for r in math_regions %}
                            <tr>
                                <td>{{ r.line_number }}</td>
                                <td>{{ r.text }}</td>
                                <td>{{ r.region }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                </table>
        </section>
        {% endif %}

        {% if solver_log %}
        <section class="panel">
                <h2>ğŸ§¾ Solver ì‹¤í–‰ ë¡œê·¸</h2>
                <details open>
                        <summary>ë¡œê·¸ í¼ì¹˜ê¸°/ì ‘ê¸°</summary>
                        <pre class="log">{{ solver_log }}</pre>
                </details>
                {% if log_file %}
                <p><a href="{{ url_for('get_log', logname=log_file.split('/')[-1]) }}" download>ë¡œê·¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</a></p>
                {% endif %}
        </section>
        {% endif %}

        <footer>
                <p>Â© 2025 Math AI Service</p>
        </footer>
</div>
</body>
</html>
